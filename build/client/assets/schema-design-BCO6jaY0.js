import{j as e}from"./chunk-OIYGIGL5-BFuAKb0n.js";let r=`A good introduction on the strength and weaknesses modelling on the various non-rdbms datastores is to be found in Ian Varley's Master thesis, [No Relation: The Mixed Blessings of Non-Relational Databases](http://ianvarley.com/UT/MR/Varley_MastersReport_Full_2009-08-07.pdf). It is a little dated now but a good background read if you have a moment on how HBase schema modeling differs from how it is done in an RDBMS. Also, read [keyvalue](/docs/architecture/regions#keyvalue) for how HBase stores data internally, and the section on [schema.casestudies](/docs/regionserver-sizing#schema-design-case-studies).

The documentation on the Cloud Bigtable website, [Designing Your Schema](https://cloud.google.com/bigtable/docs/schema-design), is pertinent and nicely done and lessons learned there equally apply here in HBase land; just divide any quoted values by \\~10 to get what works for HBase: e.g. where it says individual values can be \\~10MBs in size, HBase can do similar — perhaps best to go smaller if you can — and where it says a maximum of 100 column families in Cloud Bigtable, think \\~10 when modeling on HBase.

See also Robert Yokota's [HBase Application Archetypes](https://blogs.apache.org/hbase/entry/hbase-application-archetypes-redux) (an update on work done by other HBasers), for a helpful categorization of use cases that do well on top of the HBase model.

## Schema Creation

HBase schemas can be created or updated using the [Apache HBase Shell](/docs/shell) or by using [Admin](https://hbase.apache.org/devapidocs/org/apache/hadoop/hbase/client/Admin.html) in the Java API.

Tables must be disabled when making ColumnFamily modifications, for example:

\`\`\`java
Configuration config = HBaseConfiguration.create();
Admin admin = new Admin(conf);
TableName table = TableName.valueOf("myTable");

admin.disableTable(table);

HColumnDescriptor cf1 = ...;
admin.addColumn(table, cf1);      // adding new ColumnFamily
HColumnDescriptor cf2 = ...;
admin.modifyColumn(table, cf2);    // modifying existing ColumnFamily

admin.enableTable(table);
\`\`\`

See [client dependencies](/docs/configuration/default#client-configuration-and-dependencies-connecting-to-an-hbase-cluster) for more information about configuring client connections.

<Callout type="info">
  Online schema changes are supported in the 0.92.x codebase, but the 0.90.x codebase requires the
  table to be disabled.
</Callout>

### Schema Updates

When changes are made to either Tables or ColumnFamilies (e.g. region size, block size), these changes take effect the next time there is a major compaction and the StoreFiles get re-written.

See [store](/docs/architecture/regions#store) for more information on StoreFiles.

## Table Schema Rules Of Thumb

There are many different data sets, with different access patterns and service-level expectations. Therefore, these rules of thumb are only an overview. Read the rest of this chapter to get more details after you have gone through this list.

* Aim to have regions sized between 10 and 50 GB.
* Aim to have cells no larger than 10 MB, or 50 MB if you use [mob](/docs/architecture/hbase-mob). Otherwise, consider storing your cell data in HDFS and store a pointer to the data in HBase.
* A typical schema has between 1 and 3 column families per table. HBase tables should not be designed to mimic RDBMS tables.
* Around 50-100 regions is a good number for a table with 1 or 2 column families. Remember that a region is a contiguous segment of a column family.
* Keep your column family names as short as possible. The column family names are stored for every value (ignoring prefix encoding). They should not be self-documenting and descriptive like in a typical RDBMS.
* If you are storing time-based machine data or logging information, and the row key is based on device ID or service ID plus time, you can end up with a pattern where older data regions never have additional writes beyond a certain age. In this type of situation, you end up with a small number of active regions and a large number of older regions which have no new writes. For these situations, you can tolerate a larger number of regions because your resource consumption is driven by the active regions only.
* If only one column family is busy with writes, only that column family accomulates memory. Be aware of write patterns when allocating resources.
`,l={title:"HBase and Schema Design",description:"Comprehensive guide to designing HBase schemas, including table and column family design, rowkey strategies, and best practices for optimal performance."},h=[{href:"http://ianvarley.com/UT/MR/Varley_MastersReport_Full_2009-08-07.pdf"},{href:"/docs/architecture/regions#keyvalue"},{href:"/docs/regionserver-sizing#schema-design-case-studies"},{href:"https://cloud.google.com/bigtable/docs/schema-design"},{href:"https://blogs.apache.org/hbase/entry/hbase-application-archetypes-redux"},{href:"/docs/shell"},{href:"https://hbase.apache.org/devapidocs/org/apache/hadoop/hbase/client/Admin.html"},{href:"/docs/configuration/default#client-configuration-and-dependencies-connecting-to-an-hbase-cluster"},{href:"/docs/architecture/regions#store"},{href:"/docs/architecture/hbase-mob"}],d={contents:[{heading:void 0,content:"A good introduction on the strength and weaknesses modelling on the various non-rdbms datastores is to be found in Ian Varley's Master thesis, No Relation: The Mixed Blessings of Non-Relational Databases. It is a little dated now but a good background read if you have a moment on how HBase schema modeling differs from how it is done in an RDBMS. Also, read keyvalue for how HBase stores data internally, and the section on schema.casestudies."},{heading:void 0,content:"The documentation on the Cloud Bigtable website, Designing Your Schema, is pertinent and nicely done and lessons learned there equally apply here in HBase land; just divide any quoted values by ~10 to get what works for HBase: e.g. where it says individual values can be ~10MBs in size, HBase can do similar — perhaps best to go smaller if you can — and where it says a maximum of 100 column families in Cloud Bigtable, think ~10 when modeling on HBase."},{heading:void 0,content:"See also Robert Yokota's HBase Application Archetypes (an update on work done by other HBasers), for a helpful categorization of use cases that do well on top of the HBase model."},{heading:"schema-creation",content:"HBase schemas can be created or updated using the Apache HBase Shell or by using Admin in the Java API."},{heading:"schema-creation",content:"Tables must be disabled when making ColumnFamily modifications, for example:"},{heading:"schema-creation",content:"See client dependencies for more information about configuring client connections."},{heading:"schema-creation",content:"type: info"},{heading:"schema-creation",content:`Online schema changes are supported in the 0.92.x codebase, but the 0.90.x codebase requires the
table to be disabled.`},{heading:"schema-updates",content:"When changes are made to either Tables or ColumnFamilies (e.g. region size, block size), these changes take effect the next time there is a major compaction and the StoreFiles get re-written."},{heading:"schema-updates",content:"See store for more information on StoreFiles."},{heading:"table-schema-rules-of-thumb",content:"There are many different data sets, with different access patterns and service-level expectations. Therefore, these rules of thumb are only an overview. Read the rest of this chapter to get more details after you have gone through this list."},{heading:"table-schema-rules-of-thumb",content:"Aim to have regions sized between 10 and 50 GB."},{heading:"table-schema-rules-of-thumb",content:"Aim to have cells no larger than 10 MB, or 50 MB if you use mob. Otherwise, consider storing your cell data in HDFS and store a pointer to the data in HBase."},{heading:"table-schema-rules-of-thumb",content:"A typical schema has between 1 and 3 column families per table. HBase tables should not be designed to mimic RDBMS tables."},{heading:"table-schema-rules-of-thumb",content:"Around 50-100 regions is a good number for a table with 1 or 2 column families. Remember that a region is a contiguous segment of a column family."},{heading:"table-schema-rules-of-thumb",content:"Keep your column family names as short as possible. The column family names are stored for every value (ignoring prefix encoding). They should not be self-documenting and descriptive like in a typical RDBMS."},{heading:"table-schema-rules-of-thumb",content:"If you are storing time-based machine data or logging information, and the row key is based on device ID or service ID plus time, you can end up with a pattern where older data regions never have additional writes beyond a certain age. In this type of situation, you end up with a small number of active regions and a large number of older regions which have no new writes. For these situations, you can tolerate a larger number of regions because your resource consumption is driven by the active regions only."},{heading:"table-schema-rules-of-thumb",content:"If only one column family is busy with writes, only that column family accomulates memory. Be aware of write patterns when allocating resources."}],headings:[{id:"schema-creation",content:"Schema Creation"},{id:"schema-updates",content:"Schema Updates"},{id:"table-schema-rules-of-thumb",content:"Table Schema Rules Of Thumb"}]};const c=[{depth:2,url:"#schema-creation",title:e.jsx(e.Fragment,{children:"Schema Creation"})},{depth:3,url:"#schema-updates",title:e.jsx(e.Fragment,{children:"Schema Updates"})},{depth:2,url:"#table-schema-rules-of-thumb",title:e.jsx(e.Fragment,{children:"Table Schema Rules Of Thumb"})}];function s(a){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...a.components},{Callout:i}=n;return i||t("Callout"),e.jsxs(e.Fragment,{children:[e.jsxs(n.p,{children:["A good introduction on the strength and weaknesses modelling on the various non-rdbms datastores is to be found in Ian Varley's Master thesis, ",e.jsx(n.a,{href:"http://ianvarley.com/UT/MR/Varley_MastersReport_Full_2009-08-07.pdf",children:"No Relation: The Mixed Blessings of Non-Relational Databases"}),". It is a little dated now but a good background read if you have a moment on how HBase schema modeling differs from how it is done in an RDBMS. Also, read ",e.jsx(n.a,{href:"/docs/architecture/regions#keyvalue",children:"keyvalue"})," for how HBase stores data internally, and the section on ",e.jsx(n.a,{href:"/docs/regionserver-sizing#schema-design-case-studies",children:"schema.casestudies"}),"."]}),`
`,e.jsxs(n.p,{children:["The documentation on the Cloud Bigtable website, ",e.jsx(n.a,{href:"https://cloud.google.com/bigtable/docs/schema-design",children:"Designing Your Schema"}),", is pertinent and nicely done and lessons learned there equally apply here in HBase land; just divide any quoted values by ~10 to get what works for HBase: e.g. where it says individual values can be ~10MBs in size, HBase can do similar — perhaps best to go smaller if you can — and where it says a maximum of 100 column families in Cloud Bigtable, think ~10 when modeling on HBase."]}),`
`,e.jsxs(n.p,{children:["See also Robert Yokota's ",e.jsx(n.a,{href:"https://blogs.apache.org/hbase/entry/hbase-application-archetypes-redux",children:"HBase Application Archetypes"})," (an update on work done by other HBasers), for a helpful categorization of use cases that do well on top of the HBase model."]}),`
`,e.jsx(n.h2,{id:"schema-creation",children:"Schema Creation"}),`
`,e.jsxs(n.p,{children:["HBase schemas can be created or updated using the ",e.jsx(n.a,{href:"/docs/shell",children:"Apache HBase Shell"})," or by using ",e.jsx(n.a,{href:"https://hbase.apache.org/devapidocs/org/apache/hadoop/hbase/client/Admin.html",children:"Admin"})," in the Java API."]}),`
`,e.jsx(n.p,{children:"Tables must be disabled when making ColumnFamily modifications, for example:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(n.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:e.jsxs(n.code,{children:[e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"Configuration config "}),e.jsx(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" HBaseConfiguration."}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"create"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"();"})]}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"Admin admin "}),e.jsx(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:" new"}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:" Admin"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"(conf);"})]}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"TableName table "}),e.jsx(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" TableName."}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"valueOf"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"("}),e.jsx(n.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"myTable"'}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:");"})]}),`
`,e.jsx(n.span,{className:"line"}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"admin."}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"disableTable"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"(table);"})]}),`
`,e.jsx(n.span,{className:"line"}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"HColumnDescriptor cf1 "}),e.jsx(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" ...;"})]}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"admin."}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"addColumn"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"(table, cf1);      "}),e.jsx(n.span,{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"},children:"// adding new ColumnFamily"})]}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"HColumnDescriptor cf2 "}),e.jsx(n.span,{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" ...;"})]}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"admin."}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"modifyColumn"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"(table, cf2);    "}),e.jsx(n.span,{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"},children:"// modifying existing ColumnFamily"})]}),`
`,e.jsx(n.span,{className:"line"}),`
`,e.jsxs(n.span,{className:"line",children:[e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"admin."}),e.jsx(n.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"enableTable"}),e.jsx(n.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"(table);"})]})]})})}),`
`,e.jsxs(n.p,{children:["See ",e.jsx(n.a,{href:"/docs/configuration/default#client-configuration-and-dependencies-connecting-to-an-hbase-cluster",children:"client dependencies"})," for more information about configuring client connections."]}),`
`,e.jsx(i,{type:"info",children:e.jsx(n.p,{children:`Online schema changes are supported in the 0.92.x codebase, but the 0.90.x codebase requires the
table to be disabled.`})}),`
`,e.jsx(n.h3,{id:"schema-updates",children:"Schema Updates"}),`
`,e.jsx(n.p,{children:"When changes are made to either Tables or ColumnFamilies (e.g. region size, block size), these changes take effect the next time there is a major compaction and the StoreFiles get re-written."}),`
`,e.jsxs(n.p,{children:["See ",e.jsx(n.a,{href:"/docs/architecture/regions#store",children:"store"})," for more information on StoreFiles."]}),`
`,e.jsx(n.h2,{id:"table-schema-rules-of-thumb",children:"Table Schema Rules Of Thumb"}),`
`,e.jsx(n.p,{children:"There are many different data sets, with different access patterns and service-level expectations. Therefore, these rules of thumb are only an overview. Read the rest of this chapter to get more details after you have gone through this list."}),`
`,e.jsxs(n.ul,{children:[`
`,e.jsx(n.li,{children:"Aim to have regions sized between 10 and 50 GB."}),`
`,e.jsxs(n.li,{children:["Aim to have cells no larger than 10 MB, or 50 MB if you use ",e.jsx(n.a,{href:"/docs/architecture/hbase-mob",children:"mob"}),". Otherwise, consider storing your cell data in HDFS and store a pointer to the data in HBase."]}),`
`,e.jsx(n.li,{children:"A typical schema has between 1 and 3 column families per table. HBase tables should not be designed to mimic RDBMS tables."}),`
`,e.jsx(n.li,{children:"Around 50-100 regions is a good number for a table with 1 or 2 column families. Remember that a region is a contiguous segment of a column family."}),`
`,e.jsx(n.li,{children:"Keep your column family names as short as possible. The column family names are stored for every value (ignoring prefix encoding). They should not be self-documenting and descriptive like in a typical RDBMS."}),`
`,e.jsx(n.li,{children:"If you are storing time-based machine data or logging information, and the row key is based on device ID or service ID plus time, you can end up with a pattern where older data regions never have additional writes beyond a certain age. In this type of situation, you end up with a small number of active regions and a large number of older regions which have no new writes. For these situations, you can tolerate a larger number of regions because your resource consumption is driven by the active regions only."}),`
`,e.jsx(n.li,{children:"If only one column family is busy with writes, only that column family accomulates memory. Be aware of write patterns when allocating resources."}),`
`]})]})}function m(a={}){const{wrapper:n}=a.components||{};return n?e.jsx(n,{...a,children:e.jsx(s,{...a})}):s(a)}function t(a,n){throw new Error("Expected component `"+a+"` to be defined: you likely forgot to import, pass, or provide it.")}export{r as _markdown,m as default,h as extractedReferences,l as frontmatter,d as structuredData,c as toc};
